[mgr]

prepend_keymap = [

  # -------------------------------
  # TERMINAL OPEN (FIXED)
  # -------------------------------

  # Open a shell (terminal) inside the current directory
  # We use "$SHELL" to find your default shell (zsh/bash/fish)
  # We use --block to pause Yazi so you can use the terminal
{ on = [ "<Enter>" ], run = "open", desc = "Open" },
  { on = [ "o" ], run = "shell \"$SHELL\" --block --confirm", desc = "Open shell here" },

  # -------------------------------
  # OPEN WITH (FIXED)
  # -------------------------------

  # Micro is a TUI app, so it needs --block to show up!
  { on = [ "m" ], run = "shell 'micro \"$@\"' --block", desc = "Open in micro" },

  # VS Code is a GUI, so it can run detached (orphan) without blocking
  { on = [ "C" ], run = "shell 'code \"$@\"' --orphan", desc = "Open in VS Code" },

  # -------------------------------
  # NAVIGATION
  # -------------------------------
  
  # Note: Since you mapped <Enter> to open shell, you must use "l" or Right Arrow to enter folders.
  { on = [ "<Backspace>" ], run = "leave", desc = "Go up directory" },

  { on = [ "g", "d" ], run = "cd ~/Downloads",    desc = "Go to Downloads" },
  { on = [ "g", "c" ], run = "cd ~/.config",      desc = "Go to Config" },
  { on = [ "g", "h" ], run = "cd ~",              desc = "Go Home" },
  { on = [ "g", "v" ], run = "cd ~/.local/bin",   desc = "Go to Scripts" },
  { on = [ "g", "p" ], run = "cd ~/Projects",     desc = "Go to Projects" },

  # -------------------------------
  # SELECTION & VISIBILITY
  # -------------------------------

  { on = [ "." ], run = "hidden toggle", desc = "Toggle hidden files" },
  { on = [ "<Space>" ], run = [ "select --state=none", "arrow 1" ], desc = "Toggle selection" },
  { on = [ "v" ], run = "visual_mode", desc = "Visual range select" },
  { on = [ "V" ], run = "select --all", desc = "Select all" },
  { on = [ "I" ], run = "select --invert", desc = "Invert selection" },
  { on = [ "u" ], run = "select --none", desc = "Unselect all" },

  # -------------------------------
  # COPY
  # -------------------------------
  { on = [ "y" ], run = [ "yank", "shell --confirm 'printf \"%s\n\" \"$@\" | wl-copy'" ], desc = "Copy path(s)" },
]
